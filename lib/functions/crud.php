<?php/*      Element Form Action Functions    These are used to process and action forms    _getValues(table name, id field name)    gets the value of ID from the table and returns data to be stored in any type of array.    Ie. $result = _getValues("customers","customer_id");    _submitForm("table name","id field")    used to submit the field, this function pick's up all "frm_" requests and assumes they are mysql table columns.    it will then update the column  with the specified ID in with the data    if no id number is given it will create a new record with the data and assign an ID            These are a bit old, but god they have proven themselves.        Cody Joyce*/function _getValues($table, $idfield) {    	$db_database = app("db_database");    if (req("frm_" . $idfield)) {//if a field row has been requested        $idvalue = req("frm_" . $idfield);        $query = "select * from $table where $idfield = $idvalue";		$result = query($query);        if (is_object($result))            return mysqli_fetch_array($result);    } else {        $query = "            SELECT column_name            FROM information_schema.columns            WHERE table_schema = '$db_database'            AND table_name = '$table'            ORDER BY ordinal_position				            ";        $result = query($query);		        while ($row = mysqli_fetch_array($result)) {                        $values[$row['column_name']] = null;            if (req('frm_' . $row['column_name'])) {                $values[$row['column_name']] = req('frm_' . $row['column_name']);				$values[$row['column_name']] = stripslashes($values[$row['column_name']]);				$values[$row['column_name']]=  htmlspecialchars($values[$row['column_name']]);            }        }        return $values;    }}function _submitForm($table, $idfield) {    $update_field_id = req("frm_$idfield");    $sql_field_names = null;    $sql_field_values = null;    $updateString = null;    $result = 0;    $getTable = query("SELECT * FROM $table");    if (is_object($getTable)) {        while ($table_field = mysqli_fetch_field($getTable)) {            $table_field_type["$table_field->name"] = $table_field->type;        }        foreach ($_REQUEST as $request_field => $request_value) {            if (strstr($request_field, "frm_") && !strstr($request_field, $idfield)) {                $request_field = str_replace("frm_", "", $request_field);                $request_value = addslashes($request_value);                $request_value = htmlspecialchars($request_value);								$sql_field_names .= $request_field . ",";                if ($table_field_type["$request_field"] == "int") {                    $sql_field_values .= "0" . $request_value . ",";                    $updateString .= "$request_field = $request_value,";                } else {                    $sql_field_values .= "'" . $request_value . "',";                    $updateString .= "$request_field = '$request_value',";                }            }        }        $sql_field_names = substr($sql_field_names, 0, -1);        $sql_field_values = substr($sql_field_values, 0, -1);        $updateString = substr($updateString, 0, -1);        if ($update_field_id == "") {            $query = "INSERT INTO $table ($sql_field_names) VALUES ($sql_field_values);";        } else {            $query = "UPDATE $table SET $updateString WHERE $idfield = $update_field_id;";        }		//echo $query;        $result = query($query);        if ($result) {            return "Your query has been processed";        } else {            return "There was an error in your query : $query";        }    } else {        return "Not a valid table in _buildQuery - $table";    }}?>