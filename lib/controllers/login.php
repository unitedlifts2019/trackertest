<?php    /*        Login Controller - User Login and logout. This is usually the default class and function (login->index)        Cody Joyce    */    $login = new login();    class login     {        function index()         {            header("Access-Control-Allow-Origin: *");			if (sess("auth_level") == 0) {                view_core("login", null);            } else {                view_core("home", null);            }        }        function doLogin()         {            header("Access-Control-Allow-Origin: *");			$username = req("username"); //sanitize            $password = req("password"); //sanitize            $password = md5($password);            $query = "select * from users where username='$username' AND password = '$password'";            $result = query($query);            $loggedin = mysqli_num_rows($result);            if ($loggedin == 1) {                $row = mysqli_fetch_array($result);                sess('user_id',$row["user_id"]);                sess('username',$row["username"]);                sess('realname',$row["realname"]);                sess('auth_level',$row["auth_level"]);                sess('user_ip',$_SERVER['REMOTE_ADDR']);                                redirect(app('url')."/exec/login");            } else {                redirect(app('url'));            }        }        function doLogout()         {            session_unset();            redirect(app('url'));        }    }?>